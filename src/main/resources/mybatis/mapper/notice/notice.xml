<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pickmeup.jobstartup.notice.repository.NoticeRepository">
    <insert id="insertNoticeDTO" parameterType="com.pickmeup.jobstartup.notice.dto.NoticeDTO">
        <![CDATA[
            INSERT INTO NOTICE (NOT_TITLE, NOT_CONTENT)
            VALUES (#{not_title}, #{not_content})
        ]]>
        <!-- INSERT 후(order="AFTER")의 결과를 not_no(keyProperty="not_no", parameterType="NoticeDTO")에 넣어주고 아래 sql 문 실행-->
        <selectKey resultType="long" order="AFTER" keyProperty="not_no">
            <![CDATA[
                SELECT MAX(not_no) FROM NOTICE
            ]]>
        </selectKey>
    </insert>
    <select id="selectNoticeNo" resultType="long">
        <![CDATA[
            SELECT MAX(not_no) FROM NOTICE
        ]]>
    </select>
    <insert id="insertNoticeFileDTO" parameterType="com.pickmeup.jobstartup.notice.dto.NoticeFileDTO">
        <![CDATA[
            INSERT INTO NOTICE_FILE (NOT_NO, NOTFILE_ORGNAME, NOTFILE_SAVNAME, NOTFILE_TYPE)
            VALUES (#{not_no}, #{notFile_orgName}, #{notFile_savName}, #{notFile_type})
        ]]>
    </insert>

    <select id="selectNoticeList" parameterType="com.pickmeup.jobstartup.common.paging.Criteria" resultType="com.pickmeup.jobstartup.notice.dto.NoticeDTO">
        <![CDATA[
            SELECT * FROM (SELECT /*+ INDEX_DESC(NOTICE SYS_C0026505)*/ ROWNUM AS ROW_NUM, NOT_NO, NOT_TITLE, NOT_CONTENT, NOT_REGDATE, NOT_MODDATE FROM NOTICE WHERE ROWNUM <= #{currentPageNo}*#{recordsPerPage})
            WHERE ROW_NUM > #{startPage}
        ]]>
    </select>

    <select id="selectNoticeCnt" parameterType="com.pickmeup.jobstartup.common.paging.Criteria" resultType="int">
        SELECT COUNT(not_no) FROM NOTICE
    </select>
</mapper>